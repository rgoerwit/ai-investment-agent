# Multi-Agent Investment Analysis System - Environment Configuration
# Copy this file to .env and fill in your API keys

# =============================================================================
# REQUIRED API KEYS
# =============================================================================

# Google Gemini API Key (Required)
# This is the primary LLM for all analysis agents
# Get your key from: https://aistudio.google.com/app/apikey
GOOGLE_API_KEY=your_google_api_key_here

# Finnhub API Key (Required)
# Get your key from: https://finnhub.io/register
FINNHUB_API_KEY=your_finnhub_api_key_here

# Tavily API Key (Required)
# Get your key from: https://tavily.com/
TAVILY_API_KEY=your_tavily_api_key_here

# =============================================================================
# OPTIONAL DATA SOURCE API KEYS (Improve international stock coverage)
# =============================================================================

# Alpha Vantage API Key (Optional - free tier: 25 requests/day)
# High-quality fundamentals for international stocks
# Get your key from: https://www.alphavantage.co/support/#api-key
ALPHAVANTAGE_API_KEY=your_alphavantage_api_key_here

# FMP - Financial Modeling Prep (Optional - fallback in case Yahoo is missing data)
FMP_API_KEY=your_fmp_key_here

# EODHD - EOD Historical Data (Optional - premium international data)
EODHD_API_KEY=your_eodhd_key_here

# =============================================================================
# CONSULTANT NODE CONFIGURATION (Optional - Cross-validation)
# =============================================================================

# OpenAI API Key (Optional - for external consultant node)
# The consultant uses a different LLM (OpenAI) to cross-validate Gemini's work
# This helps detect biases and groupthink that a single model might miss
# Get your key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# Model to use for consultant reviews (external validation)
# Recommended: gpt-4o (GPT-4 Omni, latest as of Dec 2025)
# Alternative: gpt-4-turbo (faster, slightly less capable)
# Note: ChatGPT 5.2 is not yet available via API as of Dec 2025
CONSULTANT_MODEL=gpt-4o

# Enable/disable consultant node (set to false to skip consultant review)
# When disabled, the graph skips the consultant and routes directly from Research Manager to Trader
ENABLE_CONSULTANT=true

# Analogous to QUICK_MODEL below (used for Gemini)
CONSULTANT_QUICK_MODEL=gpt-4o-mini

# =============================================================================
# LANGSMITH CONFIGURATION (Optional - for observability and tracing)
# =============================================================================

# LangSmith API Key
# Get your key from: https://smith.langchain.com/
LANGSMITH_API_KEY=your_langsmith_api_key_here

# LangSmith Workspace ID (Required if using org-scoped API key)
# Find your workspace ID in LangSmith Settings → Workspaces
# This should be a UUID, not "default"
LANGSMITH_WORKSPACE_ID=your_workspace_uuid_here

# Enable/disable LangSmith tracing:
#   Set to false to disable tracing; true sends metrics to LangSmith 
#   for debugging/monitoring
LANGSMITH_TRACING=false

# LangSmith project name (optional)
LANGSMITH_PROJECT=multi-agent-trading

# =============================================================================
# MODEL CONFIGURATION (IMPORTANT - Updated Dec 2025)
# =============================================================================

# ⚠️ IMPORTANT: Use Gemini 3+ models for QUICK_MODEL to avoid tool-calling bugs!
# Gemini 2.x models (2.0-flash, 2.5-flash) have known tool-calling bugs with
# langchain-google-genai 2.1.12 that can cause data gathering failures.
#
# The system uses a TWO-TIER architecture:
# - QUICK_MODEL: Used by data gathering agents (Market, Social, News, Fundamentals)
#                and synthesis agents in --quick mode. Automatically sets
#                thinking_level="low" for Gemini 3+ models.
# - DEEP_MODEL:  Used by synthesis agents (Bull/Bear, Research Manager, Portfolio
#                Manager, Risk Analysts) in normal mode. Automatically sets
#                thinking_level="high" for Gemini 3+ models.
#
# RECOMMENDED CONFIGURATION:
QUICK_MODEL=gemini-3-pro-preview  # Safe for tool calling, thinking_level="low"
# QUICK_MODEL=gemini-2.5-flash    # ⚠️ WARNING: Tool-calling bugs with SDK 2.1.12

# Model to use for deep analysis (more thorough, complex reasoning)
# Default: gemini-3-pro-preview (New release Nov 19, 2025)
DEEP_MODEL=gemini-3-pro-preview   # Reliable, thinking_level="high" in normal mode

# =============================================================================
# MEMORY SYSTEM CONFIGURATION
# =============================================================================

# Enable persistent learning across analysis runs
# When enabled, agents remember past analyses and improve over time
ENABLE_MEMORY=true

# =============================================================================
# CHROMADB CONFIGURATION
# =============================================================================

# ChromaDB persistence directory (optional)
# CHROMA_PERSIST_DIRECTORY=./chroma_db

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Enable structured JSON logging
STRUCTURED_LOGGING=true

# =============================================================================
# OPTIONAL ADVANCED SETTINGS
# =============================================================================

# OpenAI API base URL (for custom endpoints)
# OPENAI_API_BASE=https://api.openai.com/v1

# Request timeout in seconds
# REQUEST_TIMEOUT=60

# Maximum retries for API calls
# MAX_RETRIES=3

# =============================================================================
# GEMINI API RATE LIMITING
# =============================================================================
# Configure rate limit based on your Gemini API tier:
#   - Free tier: 15 RPM (default if not set)
#   - Paid tier 1: 360 RPM
#   - Paid tier 2: 1000 RPM
#
# The system automatically applies a 20% safety margin to avoid hitting limits.
# Uncomment and set based on your tier:
# GEMINI_RPM_LIMIT=15    # Free tier (default)
# GEMINI_RPM_LIMIT=360   # Paid tier 1
# GEMINI_RPM_LIMIT=1000  # Paid tier 2

# =============================================================================
# NOTES
# =============================================================================
# 
# 1. Never commit the .env file to version control
# 2. Keep your API keys secure and rotate them regularly
# 3. Monitor your API usage to avoid unexpected charges
# 4. LangSmith tracing is optional but highly recommended for debugging
# 5. Use QUICK_MODEL for development/testing to save costs
# 6. ENABLE_MEMORY allows agents to learn from past analyses