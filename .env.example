# Multi-Agent Investment Analysis System - Environment Configuration
# Copy this file to .env and fill in your API keys

# =============================================================================
# REQUIRED API KEYS
# =============================================================================

# Google Gemini API Key (Required)
# This is the primary LLM for all analysis agents
# Get your key from: https://aistudio.google.com/app/apikey
GOOGLE_API_KEY=your_google_api_key_here

# Finnhub API Key (Required)
# Get your key from: https://finnhub.io/register
FINNHUB_API_KEY=your_finnhub_api_key_here

# Tavily API Key (Required)
# Get your key from: https://tavily.com/
TAVILY_API_KEY=your_tavily_api_key_here

# =============================================================================
# OPTIONAL DATA SOURCE API KEYS (Improve international stock coverage)
# =============================================================================

# Alpha Vantage API Key (Optional - free tier: 25 requests/day)
# High-quality fundamentals for international stocks
# Get your key from: https://www.alphavantage.co/support/#api-key
ALPHAVANTAGE_API_KEY=your_alphavantage_api_key_here

# FMP - Financial Modeling Prep (Optional - fallback in case Yahoo is missing data)
FMP_API_KEY=your_fmp_key_here

# EODHD - You need to get the (more expensive) plan that includes fundamentals data
EODHD_API_KEY=your_eodhd_key_here

# =============================================================================
# CONSULTANT NODE CONFIGURATION (Optional - Cross-validation)
# =============================================================================

# OpenAI API Key (Optional - for external consultant node)
# The consultant uses a different LLM (OpenAI) to cross-validate Gemini's work
# This helps detect biases and groupthink that a single model might miss
# Get your key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# Model to use for consultant reviews (external validation)
# Recommended: gpt-4o (GPT-4 Omni, latest as of Dec 2025)
# Alternative: gpt-4-turbo (faster, slightly less capable)
# Note: ChatGPT 5.2 is not yet available via API as of Dec 2025
CONSULTANT_MODEL=gpt-4o

# Enable/disable consultant node (set to false to skip consultant review)
# When disabled, the graph skips the consultant and routes directly from Research Manager to Trader
ENABLE_CONSULTANT=true

# Analogous to QUICK_MODEL below (used for Gemini)
CONSULTANT_QUICK_MODEL=gpt-4o-mini

# Math-capable model, please
AUDITOR_MODEL=gpt-4o-mini

# =============================================================================
# LANGSMITH CONFIGURATION (Optional - for observability and tracing)
# =============================================================================

# LangSmith API Key
# Get your key from: https://smith.langchain.com/
LANGSMITH_API_KEY=your_langsmith_api_key_here

# LangSmith Workspace ID (Required if using org-scoped API key)
# Find your workspace ID in LangSmith Settings â†’ Workspaces
# This should be a UUID, not "default"
LANGSMITH_WORKSPACE_ID=your_workspace_uuid_here

# Enable/disable LangSmith tracing:
#   Set to false to disable tracing; true sends metrics to LangSmith
#   for debugging/monitoring
LANGSMITH_TRACING=false

# LangSmith project name (optional)
LANGSMITH_PROJECT=multi-agent-trading

# LangSmith endpoint (optional)
# LANGSMITH_ENDPOINT="https://api.smith.langchain.com"

# =============================================================================
# LANGFUSE CONFIGURATION (Optional - Open Source Alternative to LangSmith)
# =============================================================================

# Enable Langfuse tracing (set to true to enable)
# Langfuse provides open-source LLM observability with self-hosting option
LANGFUSE_ENABLED=false

# Langfuse API Keys
# Get your keys from: https://cloud.langfuse.com (EU) or https://us.cloud.langfuse.com (US)
LANGFUSE_PUBLIC_KEY=pk-lf-your_public_key_here
LANGFUSE_SECRET_KEY=sk-lf-your_secret_key_here

# Langfuse Base URL
# EU (default): https://cloud.langfuse.com
# US region: https://us.cloud.langfuse.com
# Self-hosted: https://your-langfuse-instance.com
LANGFUSE_BASE_URL=https://cloud.langfuse.com

# Trace sample rate (0.0 to 1.0) - reduce to lower costs in production
# 1.0 = trace all requests, 0.2 = trace 20% of requests
LANGFUSE_SAMPLE_RATE=1.0

# Debug mode for troubleshooting Langfuse integration
LANGFUSE_DEBUG=false

# Environment tag (appears in Langfuse dashboard for filtering)
LANGFUSE_TRACING_ENVIRONMENT=development

# =============================================================================
# MODEL CONFIGURATION (IMPORTANT - Updated Dec 2025)
# =============================================================================

# The system uses a TWO-TIER architecture:
# - QUICK_MODEL: Used by data gathering agents (Market, Social, News, Fundamentals)
#                and synthesis agents in --quick mode.
# - DEEP_MODEL:  Used by synthesis agents (Bull/Bear, Research Manager, Portfolio
#                Manager, Risk Analysts) in normal mode.
#
# QUICK_MODEL=gemini-2.5-flash
QUICK_MODEL=gemini-2.0-flash

# Model to use for deep analysis (more thorough, complex reasoning)
DEEP_MODEL=gemini-3-pro-preview

# LLM provider. Default is 'google'. 'openai' is also supported.
LLM_PROVIDER=google

# =============================================================================
# MEMORY SYSTEM CONFIGURATION
# =============================================================================

# Enable persistent learning across analysis runs
# When enabled, agents remember past analyses and improve over time
ENABLE_MEMORY=true

# =============================================================================
# CHROMADB CONFIGURATION
# =============================================================================

# ChromaDB persistence directory (optional)
CHROMA_PERSIST_DIR=./chroma_db

# =============================================================================
# LOGGING AND OUTPUT CONFIGURATION
# =============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Suppress unnecessary output for cleaner logs
QUIET_MODE=false

# Directory for storing analysis results
RESULTS_DIR=./results

# Directory for caching data
DATA_CACHE_DIR=./data_cache

# =============================================================================
# AGENT AND TRADING CONFIGURATION
# =============================================================================

# Maximum number of debate rounds between Bull and Bear agents
MAX_DEBATE_ROUNDS=2

# Maximum number of discussion rounds for risk analysis
MAX_RISK_DISCUSS_ROUNDS=1

# Enable or disable online tools for agents
ONLINE_TOOLS=true

# Maximum position size as a fraction of the portfolio
MAX_POSITION_SIZE=0.1

# Maximum number of trades per day
MAX_DAILY_TRADES=5

# Risk-free rate for financial calculations
RISK_FREE_RATE=0.03

# Default ticker to analyze if none is provided
DEFAULT_TICKER=AAPL

# =============================================================================
# API AND SYSTEM CONFIGURATION
# =============================================================================

# API request timeout in seconds
API_TIMEOUT=300

# Maximum number of retries for API calls
API_RETRY_ATTEMPTS=10

# Gemini API rate limit (requests per minute)
# Free tier: 15 RPM | Paid tier (Tier 1): 360 RPM | Tier 2: 1000+ RPM
GEMINI_RPM_LIMIT=15

# Maximum characters per Tavily search result (prevents token bloat)
# Default: 7000 chars (~1750 tokens per search)
TAVILY_MAX_CHARS=7000

# System environment ('dev', 'prod', etc.)
ENVIRONMENT=dev

# Directory for agent prompts
PROMPTS_DIR=./prompts

# =============================================================================
# TELEMETRY AND SYSTEM OVERRIDES (Advanced)
# =============================================================================

# Disable ChromaDB anonymous telemetry
DISABLE_CHROMA_TELEMETRY=true

# Enable gRPC fork support (Critical for Apple Silicon/macOS compatibility)
GRPC_ENABLE_FORK_SUPPORT=true

# gRPC poll strategy ('poll' is most compatible for macOS)
GRPC_POLL_STRATEGY=poll

# =============================================================================
# NOTES
# =============================================================================
#
# 1. Never commit the .env file to version control
# 2. Keep your API keys secure and rotate them regularly
# 3. Monitor your API usage to avoid unexpected charges
# 4. LangSmith tracing is optional but highly recommended for debugging
# 5. Use QUICK_MODEL for development/testing to save costs
# 6. ENABLE_MEMORY allows agents to learn from past analyses
